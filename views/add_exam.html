<html>
    <head>
        <title>Add Exam</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        
    </head>
    <body>
        <!-- NAVBAR STARTS -->

      <nav class="navbar navbar-expand-lg site-header sticky-top py-1"  style= "background-color: #f4eeff">
     
        <div class="container d-flex flex-column flex-md-row justify-content-between">
          <a class="py-2" href="/" aria-label="Product">
            <svg xmlns="https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcSvPFOw1bQ5mtMPkEn_iUwLcSGFksFHEq9BAA&usqp=CAU" width="24" height="24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="d-block mx-auto" role="img" viewBox="0 0 25 25" focusable="false">
        <title>Logo</title>
        <circle cx="12" cy="12" r="11"/>
        <path xmlns="https://i.pinimg.com/originals/4a/8a/f3/4a8af3d932e3d5b4f83f6bdd99e45e3b.png"/>
            </svg>
          </a>
          <a class="py-2 d-none d-md-inline-block" href="/register"> Register </a>
          <a class="py-2 d-none d-md-inline-block" href="#"> Meet our team </a>
          <a class="py-2 d-none d-md-inline-block" href="logout"> Logout </a>

        </div>
      </nav>

      <!-- NAVBAR ENDS -->
    <div style="margin: 40;" >
        <div class="container col-md-7" style="border-style: solid; border-width: 1; border-radius: 25px; padding: 10px; padding-left: 25px; padding-right: 25px;">
            <u><h3>Add Exam</h3></u>
            <form method="POST">
                <div class="form-group">
                    <label>Exam ID: </label>&nbsp;
                    <input type="text" required class="form-control" id="exam_id">
                </div>
                <div class="form-group">
                    <label>Batch: </label>&nbsp;
                    <select name="batch" id="batch" onchange="populate()">
                        <option value="">select</option>
                        <option value="2017">2017</option>
                        <option value="2018">2018</option>
                        <option value="2019">2019</option>
                        <option value="2020">2020</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Branch </label>&nbsp;
                    <select name="branch" id="branch" onchange="populate()">
                        <option value="">select</option>
                        <option value="CE">CE</option>
                        <option value="IT">IT</option>
                        <option value="MH">MH</option>
                        <option value="EC">EC</option>
                        <option value="CL">CL</option>
                        <option value="CH">CH</option>
                        <option value="IC">IC</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Semester </label>&nbsp;
                    <select name="sem" id="sem" onchange="populate()">
                        <option value="">select</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Subject ID: </label>&nbsp;
                    <select name="sub_id" id="sub_id"></select>
                </div>
                
                <div class="form-group">
                    <label>Exam type: </label>&nbsp;<br>
                    <select name="exam_type" id="type">
                        <option value="Sessional_1">Sessional 1</option>
                        <option value="Sessional_2">Sessional 2</option>
                        <option value="Sessional_3">Sessional 3</option>
                        <option value="External">External</option>
                        <option value="Viva">Viva</option>
                        <option value="Practical">Practical</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Maximum marks: </label>&nbsp;
                    <input type="number" class="form-control" id="max_mks">
                </div>
                <div class="form-group">
                    <label>Exam Year: </label>&nbsp;
                    <input type="number" class="form-control" id="exam_year">
                </div>
                <button type="button" class="btn btn-primary" id="submit">Submit</button>
            </form>
        </div>
    </div>

     <!-- footer-->
      
     <footer class="blog-footer" style="text-align:center; background-color: #beebe9; height: 12%;">
        <p>Thank you      <a href="/">   Resino    </a> by   <a href="www.csi.ac.in">  @csi  </a>  . </p>
        <p>
          <a href="#">Back to top</a>
        </p>
      </footer>
      
      <!-- footer ends-->
    </body>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script>
        var max_mks 
        function populate(){
            $.ajax({
                type: "POST",
                url:"http://localhost:3000/current_subs",
                dataType: "json",
                data: {
                    batch : document.getElementById("batch").value,
                    branch : document.getElementById("branch").value,
                    sem : document.getElementById("sem").value
                },
                success: function(result){
                    
                    var selectHTML;
                    $("#sub_id").empty();
                    for (let i = 0; i < result.length; i++) 
                    {
                        selectHTML = "<option value='"+result[i].subject_id+"'>"+ result[i].subject_id + " - " + result[i].Subject_name +"</option>";
                        // console.log( result[i].subject_id + " - " + result[i].Subject_name )
                        $("#sub_id").append(selectHTML);
                    }
                },
                failure: function(err){
                    console.log(err);
                }
            })
        }
    </script>
    <script>
        $(document).ready( function(){
            $("#submit").click(function(){
                console.log("submit");
                $.ajax({
                    type: "POST",
                    url:"http://localhost:3000/add_exam",
                    dataType: "json",
                    data: {
                        exam_ID : document.getElementById("exam_id").value,
                        sub_ID : document.getElementById("sub_id").value,
                        type : document.getElementById("type").value,
                        max_mks : document.getElementById("max_mks").value,
                        exam_year : document.getElementById("exam_year").value,
                        sem : document.getElementById("sem").value
                    },
                    success: function(result){
                        console.log(JSON.stringify(result));
                        alert("Exam added")
                    },
                    failure: function(err){
                        console.log(err);
                    }
                })
            })
        })
    </script>

</html>